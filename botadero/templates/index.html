<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
	  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- This file is part of "el Botadero"
     Copyright Rodrigo Garcia 2018 <strysg@riseup.net>
     AGPL liberated
-->
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="shortcut icon" href="{{ url_for('static', filename='botadero_resources/favicon.png') }}">
    <title>Archivador temporal para compartir archivos</title>
    {% set archivo_esquema_colores = dv['esquemaColores'] + "/base.css" %}
    <link rel="stylesheet" href="{{ url_for('static', filename=archivo_esquema_colores) }}" type="text/css" />

  </head>
  
  <body>
    <h1>"El Botadero"</h1>
    <div class="qu">
      Un sitio <b>público</b> para compartir archivos
    </div>

    <!-- Categorias -->
    <span id="categoria_actual" value="{{ dv['categoriaActual'] }}" hidden>{{ dv['categoriaActual'] }}</span>

    <div id="categorias">
      {% for catName in dv['categorias'] %}
	{% if catName == 'Misc.' %}
	  <span {% if catName == dv['categoriaActual'] %}class="categoria"{% endif %}><a href="/">#{{ catName }}/</a></span>
	{% else %}
	  <span {% if catName == dv['categoriaActual'] %}class="categoria"{% endif %}><a href="/{{ catName }}/">#{{ catName }}</a> </span>
	{% endif %}
      {% endfor %}
    </div>

    <!-- Subida de archivos -->
    {% if dv['categoriaActual'] == "" %}
      <form method="post" id="upload_file" action="/almacen/upload_file" enctype="multipart/form-data">
    {% else %}
	<form method="post" id="upload_file" action="/almacen/{{ categoriaActual }}/upload_file" enctype="multipart/form-data">	
    {% endif %}

    <!-- caja drag and drop -->
    <div id="dropbox">
      Arrastra archivos aquí
    </div>
    
    <input id="file-picker" type="file" name="file" multiple>
    
    <!-- <input type="file" name="file"/> -->
    <input type="submit" class="btn large" id="upload-button" value="Compartir archivo(s)"/>
    
    <div class="nota">
      <p> Los archivos se eliminan después de {pendiente} a {pendeinte} días, dependiendo de su tamaño (máximo <i>{ ms//1000000 }</i> MB). <span id="max_filesize" hidden>{ ms }</span>
	<a href="/info" >ver información</a>
      </p>
    </div>

	</form>	

	<!-- Barra de progreso -->
	<fieldset id="progress" style="display: none">
	  <legend id="estado-recepcion">Recibiendo archivo(s):</legend>
	  <div class="progress-trough">
	    <div id="progress-bar" class="progress-bar">0%</div>
	  </div>
	</fieldset>

	<!-- Estadisticas generales -->
	<p>
	  { pendiente} MB disponibles (<b>{ pendiente}%</b>) Total de <b>{ pendiente }</b> archivos
	</p>

	<!-- Listado de Archivos -->	
	<div id="caja_archivos" class="caja_lista_archivos">

	  {% for archivoObj in dv['archivos'] %}
	    <p class="lista_archivos_elemento">
		<a href="/almacen/{{ dv['categoriaActual'] }}/{{ archivoObj['name'] }}">{{ archivoObj['name'] }}</a>

	      {% if archivoObj['size'] < 1000 %}
		<span class="label">{{ archivoObj['size'] }} B</span>
	      {% elif archivoObj['size'] >= 1000 and archivoObj['size'] < 1000000 %}
		<span class="label">{{ '%0.2f'|format(archivoObj['size']/1000) }} KB</span>
	      {% elif archivoObj['size'] >= 1000000 and archivoObj['size'] < 1000000000 %}
		<span class="label">{{ '%0.2f'|format(archivoObj['size']/1000000) }} MB</span>
	      {% elif archivoObj['size'] >= 1000000000 %}
		<span class="label">{{ '%0.2f'|format(archivoObj['size']/1000000000) }} GB</span>
	      {% endif %}

	      {% if archivoObj['restante'] >= 10 %}
		<span class="label success">{{ archivoObj['restante'] }} días</span>
	      {% elif archivoObj['restante'] < 10 and  archivoObj['restante'] > 3 %}
		<span class="label warning">{{ archivoObj['restante'] }} días</span>
	      {% elif archivoObj['restante'] <= 3 %}
		<span class="label important">{{ archivoObj['restante'] }} días</span>
	      {% endif %}
	    </p>
	  {% endfor %}
	</div>
	<br>
	<!-- Categorias -->
	<div id="categorias">
	  {% for catName in dv['categorias'] %}
	    {% if catName == 'Misc.' %}
	      <span {% if catName == dv['categoriaActual'] %}class="categoria"{% endif %}><a href="/">#{{ catName }}/</a></span>
	    {% else %}
	      <span {% if catName == dv['categoriaActual'] %}class="categoria"{% endif %}><a href="/{{ catName }}/">#{{ catName }}</a> </span>
	    {% endif %}
	  {% endfor %}
	</div>

	<div class="nota">
	  <p>Revisa las <a href="/estadisticas" > estadísticas </a> de los archivos.
	  </p>
	</div>
	
	<!-- Notas al pie -->
	<div class="qu">
	  " La sabiduría crece cuando se comparte los conocimientos "
	  <p> <a href="https://notabug.org/strysg/botadero">Código fuente</a> de esta aplicación.</p>
	</div>


	<!-- javascript -->
	<script type="text/javascript" src="{{ url_for('static', filename='js/jquery-2.1.1.min.js') }}"></script>
	<script type="text/javascript" src="{{ url_for('static', filename='js/upload.js') }}"></script>
	
  </body>

</html>
